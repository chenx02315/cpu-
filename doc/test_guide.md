
# 🧪 CPU测试指南

## 测试文件说明

### 1. 基础测试 - `cpu_tb.v`
```bash
make test          # 使用基础测试
```
**用途：**
- ✅ 快速验证CPU基本功能
- ✅ 检查程序是否正常执行完毕
- ✅ 获取基本性能数据
- ✅ 日常开发验证

**输出：**
- 程序执行状态
- 基本性能统计
- 简单的错误提示

### 2. 详细调试测试 - `cpu_tb_detailed.v`
```bash
make debug_test    # 使用详细调试测试
```
**用途：**
- 🔍 逐条指令跟踪执行
- 🔍 详细寄存器变化监控
- 🔍 分支跳转分析
- 🔍 流水线状态跟踪
- 🔍 与期望结果精确对比

**输出：**
- 每条指令的详细执行信息
- 寄存器写入跟踪
- 分支跳转调试信息
- 最终结果对比

## 🎯 推荐使用策略

### 开发阶段
```bash
make test          # 先用基础测试
```
如果基础测试通过 → CPU基本正常
如果基础测试失败 → 使用详细测试调试

### 调试阶段
```bash
make debug_test    # 使用详细测试定位问题
```

### 最终验证
```bash
make test          # 确保基本功能正常
make debug_test    # 确保所有细节正确
```

## 当前问题调试

**由于你遇到了rd地址传递问题，建议：**

1. **使用详细测试**：
   ```bash
   make debug_test
   ```

2. **关注关键信息**：
   - `✅ ID/EX正确: x31 -> x31` （期望看到）
   - `❌ ID/EX致命错误` （需要修复的）
   - 总执行指令数是否达到232条
   - 寄存器匹配率是否达到100%

3. **修复验证循环**：
   ```bash
   # 修改代码后
   make clean
   make debug_test
   # 查看修复效果
   ```

## 🚀 快速测试命令

```bash
# 清理并运行详细测试
make clean && make debug_test

# 只看关键结果
make debug_test | grep -E "(✅|❌|=== |总执行|匹配)"
```
